%!TEX root = ./main.tex

\section{Combinatorial Optimization}

	``Optimization'' is the subject where we attempt to maximize/minimize some function. ``Combinatorial'' refers to the fact that the function we are trying to optimize over a finite set.\\
	In matching theory, there is a plethora of ``min-max'' results, where the maximum of some function is associated to the minimum of another.

	\begin{fdef}
		Given a bipartite graph $G(A,B)$, define the \emph{deficiency} of $G$ by
		\[ \Def(G) = \max_{X \subseteq A} |X| - |N(X)|. \]
	\end{fdef}
	Note that $\Def(G) \ge 0$ for any graph, since $|\emptyset| - |N(\emptyset)| = 0$.

	\begin{fprop}
		The size of the largest matching in a bipartite graph $G(A,B)$ is equal to $|A| - \Def(G)$.
	\end{fprop}

	Arguably the first min-max result in matching theory was the following.

	\begin{ftheo}[K\"{o}nig's Theorem]
		\label{theo: konigs theorem}
		The size of a maximum matching in a bipartite graph is equal to the minimum number of vertices required to cover all edges in the graph (a minimum vertex cover) -- the smallest subset such that every edge has at least one endpoint in the subset.
	\end{ftheo}
	This result is equivalent to Hall's Theorem.

	Proofs of min-max results usually go about by showing that one quantity is always larger than the other, then proving that there is some object of each type whose corresponding quantities are equal.

	Consider the problem of finding a maximum weight perfect matching -- given positive weights $(w_e)$ assigned to edges, find a matching of maximum weight. This is associated to a minimum problem using LP duality.\\
	For each edge, associate a variable $x_e \in \{0,1\}$ indicating whether an edge is in the matching or not. Then, finding a max weight matching amounts to the program
	\[
	\begin{array}{ll@{}ll}
	\text{maximize}  & \displaystyle\sum_{e \in E} w_{e} x_{e} &\\
	\text{subject to}& \displaystyle\sum\limits_{e \text{ incident on } v} x_{e} \le 1,  &\qquad v \in V\\\\
	                 & x_{e} \in \{0,1\},                                                &\qquad e \in E
	\end{array}
	\]
	This is an \emph{integer linear program}, which is \textsf{NP}-complete in general. We can get a normal linear program by relaxing the integrality constraint, say by allowing the $x_e$ variables to take any non-negative value.

	\begin{equation}
	\label{max-wt-pm-lp}
	\begin{array}{ll@{}ll}
	\text{maximize}  & \displaystyle\sum_{e \in E} w_{e} x_{e} &\\
	\text{subject to}& \displaystyle\sum\limits_{e \text{ incident on } v} x_{e} \le 1,  &\qquad v \in V\\\\
	                 & x_{e} \ge 0,                                                &\qquad e \in E
	\end{array}
	\end{equation}
	
	% Further, since this linear program must be maximized at some point on the boundary of the resulting polytope, whose vertices are integral points, there is a solution to this linear program that is also a solution to the integer linear program. It is possible to find such a solution efficiently by possibly adding additional constraints; we shall return to this later.\\
	The \emph{dual} of the above linear program \Cref{max-wt-pm-lp} is formed by taking a variable $y_v \ge 0$ for each vertex $v$, and multiplying the inequality corresponding to $v$ with $y_v$. This changes the second constraint to
	\[ \sum_{e\text{ incident on }v} y_v x_e \le y_v. \]
	Adding this up over all vertices gives
	\[ \sum_{\text{edges } e = uv} (y_u + y_v) x_e \le \sum_{v \in V} y_v. \]
	If the $y_v$ are such that for any edge $uv$, $y_u + y_v \ge w_e$, then
	\[ \sum_{e = uv} w_e x_e \le \sum_{e = uv} (y_u + y_v) x_e \le \sum_v y_v. \]
	From the perspective of \nameref{theo: konigs theorem} where all the $w_e$ are $1$, this just asks for a smallest vertex cover!

	We get the dual linear program

	\begin{equation}
	\label{dual-max-wt-pm-lp}
	\begin{array}{ll@{}ll}
	\text{minimize}  & \displaystyle\sum_{v \in V} y_v &\\
	\text{subject to} \displaystyle &y_u+y_v \ge w_e,  &\qquad uv = e \in E\\
	                  &y_v \ge 0,                      &\qquad v \in V
	\end{array}
	\end{equation}

	For example, consider the following graph.

	\begin{figure}[H]
		\centering
		\begin{tikzpicture}[every edge quotes/.style = {auto, font=\footnotesize, sloped, near start}]
		\foreach \phi in {1,...,2}{
		\node (\phi') at (1,2-2*\phi) {$\phi'$};
		\node (\phi) at (-1,2-2*\phi) {$\phi$};		
      	};
		\draw (1) edge["10"] (1'); % 10
		\draw (1) edge["5"] (2'); % 5
		\draw (2) edge["20"] (1'); % 20
		\draw (2) edge["13"] (2'); % 13
		% 4 7 \\ 13 1
	\end{tikzpicture}
	\end{figure}

	The linear program \eqref{max-wt-pm-lp} is optimized by setting $(x_{11'},x_{12'},x_{21'},x_{22'}) = (0,1,1,0)$, that is, the matching $\{12',21'\}$. On the other hand, the dual linear program \eqref{dual-max-wt-pm-lp} is optimized by setting $(y_1,y_2,y_1',y_2') = (4,13,7,1)$. Note that in either case, the optimum is equal to $25$! \\

	More generally, we have the following definition.

	\begin{fdef}
		\label{def:dual}
		Given the \emph{primal} linear program
		\[
		\begin{array}{ll@{}ll}
		\text{maximize}  & \displaystyle c^\top x \\
		\text{subject to} \displaystyle &Ax \le b,\\
		                  &x \ge 0,
		\end{array}
		\]
		its \emph{dual} is
		\[
		\begin{array}{ll@{}ll}
		\text{minimize}  & \displaystyle b^\top y \\
		\text{subject to} \displaystyle &A^\top y \ge c,\\
		                  &y \ge 0.
		\end{array}
		\]
	\end{fdef}

	Note that the dual of the dual of a primal is the primal itself.

	\begin{fprop}[Weak Duality]
		For any feasible solution $x$ of the primal and $y$ of the dual, $c^\top x \le b^\top y$.
	\end{fprop}

	% \begin{fprop}
	% 	If both the dual and primal are feasible, their optimum values are equal.
	% \end{fprop}

	% \begin{fprop}[Strong duality]
	% 	If the primal has a solution, then so does the dual. Furthermore, the resulting optimal values are equal.
	% \end{fprop}

	\Cref{max-wt-pm-lp} can more succinctly be written as
	\begin{equation}		
	\label{max-wt-pm-lp-2}
	\begin{array}{ll@{}ll}
	\text{maximize}  & w^\top x &\\
	\text{subject to}& \displaystyle Ax \le 1, &\\
	                 & x \ge 0,&
	\end{array}
	\end{equation}
	where $A$ is the $n \times m$ incidence matrix of the graph, with $A_{ij} = 1$ iff edge $e_j$ is incident on $v_i$. The dual LP (corresponding to \cref{dual-max-wt-pm-lp}) is
	\[
	\begin{array}{ll@{}ll}
	\text{minimize}  & 1^\top y &\\
	\text{subject to}& \displaystyle A^\top y \ge w, \\
	                 & y \ge 0.
	\end{array}
	\]

	More explicitly,

	\[
	\begin{array}{ll@{}ll}
	\text{minimize}  & \sum_{v \in V} y_v &\\
	\text{subject to}& \displaystyle y_u + y_v \ge w_e, & \qquad uv = e \in E, \\
	                 & y_v \ge 0, & \qquad v \in V.
	\end{array}
	\]

	% If the graph is bipartite, the matching has an integral optimal solution.\\
	Given a linear program (as in \Cref{def:dual}, say), the \emph{feasible region} of the LP is $\{x \in \R^m : Ax \le 1, x \ge 0\}$, which is a convex polytope -- the convex hull of finitely many points. A \emph{vertex} of a polytope is a point in it that is not a convex combination of two distinct points in the polytope. It may be shown that any linear program has an optimum at a vertex of the polytope. More generally, the set of points where the optimum is attained is some face of the polytope. An \emph{integral polytope} is one whose vertices have integral coordinates.\\

	\begin{fdef}
		Given a graph $G$, the polytope defined by \eqref{max-wt-pm-lp-2} is integral iff $G$ is bipartite.
	\end{fdef}
	\begin{proof}
		For the forward direction, we have that if the graph has an odd cycle, the point that assigns $1/2$ to the edges in the cycle and $0$ to the remaining vertices is a vertex of the polytope. Indeed, if it were a convex combination of two distinct points in the polytope, both points are forced to have the coordinates of all edges not in the cycle as $0$, and if such a point in the polytope assigned $1/2+\epsilon$ to some edge, then the next edge in the cycle can be assigned at most $1/2-\epsilon$. Repeating this argument around the cycle yields that the other edge adjacent to the edge with weight $1/2+\epsilon$ has weight at least $1/2+\epsilon$, a contradiction. \\
		% *** FINISH THE PROOF
		% For the other direction, given a non-integral point, if the graph has an even cycle, we can cyclically alternatingly perturb the weights on some even cycle by $\pm \epsilon$ to get a convex combination. If the graph has no cycle at all, so it is a tree, a similar argument works, perturbing the weight of one edge by $\pm \epsilon$ and changing the weights of the remaining edges accordingly.
	\end{proof}

	We next give an optimality criterion for a linear program.

	\begin{flem}[Complementary slackness]
		\label{complementary slackness}
		Suppose that $x,y$ are solutions to a primal LP and its dual such that
		\begin{enumerate}[label=(\alph*)]
			\item if $y_v > 0$, the $v$th inequality in the primal is tight for $x$ and
			\item if $x_e > 0$, the $e$th inequality in the dual is tight for $y$.
		\end{enumerate}
		In this case, the value of the primal for $x$ equals the value of the dual for $y$, so both have the same optimum. 
	\end{flem}

	In the context of matchings, this means that if some edge $e$ has positive $x_e$, then the sum of $y$ values of its endpoints is equal to the weight $w_e$. Similarly, if a vertex has positive $y_v$, the sum of $x_e$ values over edges $e$ incident on $v$ is equal to $1$.

	\begin{proof}[Proof of \Cref{complementary slackness} in the setting of matchings]
		The proof is immediate since
		\[ \sum_e w_e x_e = \sum_{\substack{e = uv \\ x_e > 0}} w_e x_e = \sum_{\substack{e = uv \\ x_e > 0}} ( y_u + y_v ) x_e = \sum_u y_u \sum_{e\text{ incident on } u} x_e = \sum_{u : y_u > 0} y_u. \qedhere \]
	\end{proof}

	Let us now give an algorithm for finding a max-weight matching in the bipartite setting. Start off with the dual solution $y$, where $y_u$ is the maximum weight edge incident on $u$ if $u \in A$ and $0$ otherwise.

	\begin{figure}[H]
		\centering
		\begin{tikzpicture}[every edge quotes/.style = {auto, font=\footnotesize, sloped, very near start}]
		\foreach \phi in {1,...,3}{
		\node (\phi') at (1,4-2*\phi) {$\phi'$};
		\node (\phi) at (-1,4-2*\phi) {$\phi$};		
      	};

      	\node[left of=1] {$3$};
      	\node[left of=2] {$5$};
      	\node[left of=3] {$7$};

      	\node[right of=1'] {$0$};
      	\node[right of=2'] {$0$};
      	\node[right of=3'] {$0$};
		
		\draw (1) edge["2"] (1');
		\draw (1) edge["3"] (3');

		\draw (2) edge["5"] (1');
		\draw (2) edge["4"] (2');
		\draw (2) edge["1"] (3');
		
		\draw (3) edge["6"] (2');
		\draw (3) edge["7"] (3');
		% weights 3 5 7 on left
	\end{tikzpicture}
	\end{figure}

	We will try to maintain complementary slackness by allowing only those edges take nonzero value. Consider the set of \emph{admissible} edges, namely edges which are the maximum weight edge for their $A$-vertex. Find a maximum cardinality matching in the graph formed by admissible edges -- this can be done by any old algorithm such as that which searches for augmenting paths.
	
	\begin{figure}[H]
		\centering
		\begin{tikzpicture}[every edge quotes/.style = {auto, font=\footnotesize, sloped, very near start}]
		\foreach \phi in {1,...,3}{
		\node (\phi') at (1,4-2*\phi) {$\phi'$};
		\node (\phi) at (-1,4-2*\phi) {$\phi$};		
      	};

      	\node[left of=1] {$3$};
      	\node[left of=2] {$5$};
      	\node[left of=3] {$7$};

      	\node[right of=1'] {$0$};
      	\node[right of=2'] {$0$};
      	\node[right of=3'] {$0$};
		
		\draw (1) edge["2"] (1');
		\draw (1) edge[red,"3"] (3');

		\draw (2) edge[red,"5"] (1');
		\draw (2) edge["4"] (2');
		\draw (2) edge["1"] (3');
		
		\draw (3) edge["6"] (2');
		\draw (3) edge[red,"7"] (3');
		% weights 3 5 7 on left
	\end{tikzpicture}
	\end{figure}

	If this contains a perfect matching from $A$ to $B$, this matching is a maximum weight matching. If not, there exists a subset $X$ such that $|N(X)| < |X|$. Then, increase the $y$ value of vertices in $N(X)$ by $\delta$ and decrease the $y$ value of vertices in $X$ by $\delta$, for the largest possible $\delta$. This means that we increase/decrease it until the weight of some vertex becomes $0$, or some new edge becomes admissible. In the former case, we delete that vertex from the graph.

	\begin{figure}[H]
	\centering
	\begin{tikzpicture}[every edge quotes/.style = {auto, font=\footnotesize, sloped, very near start}]
		\foreach \phi in {1,...,3}{
		\node (\phi') at (1,4-2*\phi) {$\phi'$};
		\node (\phi) at (-1,4-2*\phi) {$\phi$};		
      	};

      	\node[left of=1] {$2$};
      	\node[left of=2] {$5$};
      	\node[left of=3] {$6$};

      	\node[right of=1'] {$0$};
      	\node[right of=2'] {$0$};
      	\node[right of=3'] {$1$};
		
		\draw (1) edge["2"] (1');
		\draw (1) edge[red,"3"] (3');

		\draw (2) edge[red,"5"] (1');
		\draw (2) edge["4"] (2');
		\draw (2) edge["1"] (3');
		
		\draw (3) edge[red,"6"] (2');
		\draw (3) edge[red,"7"] (3');
	\end{tikzpicture}
	\end{figure}

	% While there exists a vertex in $A$ with $y_v > 0$ that is not matched, search for an augmenting path using only admissible edges. Once found, augment and reduce the number of unmatched vertices with $y > 0$. If any vertex in $A'$ (that have admissible edges) has $y$ value $0$, take an alternating path from $u$ to it.
	Now, how large can the $\delta$ mentioned earlier get? First off, none of the $y$ values can become negative, so define
	\[ \delta_1 = \min_{v \in A' \cup \{u\}} y_v. \]
	We also have the constraint due to formerly non-admissible edges $pq$ that might become tight due to the decrease in $y_p$ for some $p \in A'$. So, define
	\[ \delta_2 = \min_{\substack{pq \text{ not admissible} \\ p \in A', q \not\in B'}} (y_p + y_q - w_{pq}). \]
	Then, we set $\delta = \min\{\delta_1,\delta_2\}$, decreasing $y_u$ by $\delta$ for $u \in A'$, and increasing $y_v$ by $\delta$ for $v \in B'$. We repeat this process until all vertices with positive $y$ value are matched.\\

	Now, in the problem of finding a maximum weight \emph{perfect} matching, we instead have

	\[
	\label{max-wt-pm-lp}
	\begin{array}{ll@{}ll}
	\text{maximize}  & \displaystyle\sum_{e \in E} w_{e} x_{e} &\\
	\text{subject to}& \displaystyle\sum\limits_{e \text{ incident on } v} x_{e} = 1,  &\qquad v \in V\\\\
	                 & x_{e} \ge 0,                                                &\qquad e \in E
	\end{array}
	\]
	and in the dual,
	\[
	\label{dual-max-wt-pm-lp}
	\begin{array}{ll@{}ll}
	\text{minimize}  & \displaystyle\sum_{v \in V} y_v &\\
	\text{subject to} \displaystyle &y_u+y_v \ge w_e,  &\qquad uv = e \in E.
	\end{array}
	\]
	Note that the $y_v \ge 0$ constraint has been removed. The algorithm now is exactly the same as the earlier one for a maximum weight matching, except that the $y$ coordinates are allowed to be negative.\\

	This is an $O(mn)$ time algorithm, called the \emph{Hungarian method}. Some mild optimizations can bring it down to $O(m\sqrt{n})$. Recently, we got an almost linear time algorithm to find a maximum weight perfect matching! % sushant sachdeva

	Now, the problem of finding maximum weight matchings can be reduced to finding maximum weight perfect matchings by adding extra vertices with the edges having $0$ weight.\\

	In general graphs, we have
	\begin{equation}
	\label{max-wt-pm-lp-3}
	\begin{array}{ll@{}ll}
	\text{maximize}  & w^\top x &\\
	\text{subject to}& \displaystyle\sum\limits_{e \text{ incident on } v} x_{e} = 1,  &\qquad v \in V\\\\
	                 & x_{e} \ge 0,                                                &\qquad e \in E
	\end{array}
	\end{equation}
	This is in general not an integral polytope.
	If the graph has no odd cycles, it is bipartite so integral, by an argument similar to the previous one. Even in the case where it does have odd cycles, the graph could be integral, an example being $K_4$.
	% still integral K_4

	Generally, graphs for which this polytope is integral are called \emph{Birkhoff-von Neumann} graphs. There is no characterization known for such graphs.\\
	Suppose we have a graph with two odd cycles, with the remaining vertices having a perfect matching among themselves. Then, the point assigning $1$ to the matching and $1/2$ to all vertices in the odd cycle is a vertex of the polytope.
	% 
	\begin{flem}
		\label{lem:matching-polytope-lem}
		Let $G$ be a matching-covered graph, that is, a connected graph where every edge is in a perfect matching. The polytope defined by \eqref{max-wt-pm-lp-3} is not integral iff $G$ contains two disjoint odd cycles such that the remaining graph has a perfect matching.
	\end{flem}
	% cannot have an even cycle
	% no edge in more than one cycle
	% any vtx with nonzero degree has degree at least 2
	% any component has exactly one odd cycle

	This gives some sort of co-\textsf{NP} characterization of which graphs have integral perfect matching polytopes, but it is unclear how to check this property.
	% add more LP inequalities (making it exponentially large), but this can still be solved in poly time

	\begin{fdef}
		Given a graph $G = (V,E)$ with a perfect matching, identify each perfect matching $M$ of $G$ with the vector $x \in \R^E$, where $x_e = 1$ if $e \in M$ and $0$ otherwise. The \emph{perfect matching polytope} of $G$ is the convex hull of these points. The \emph{matching polytope} is defined similarly.
	\end{fdef}

	However, this polytope may have exponentially many vertices, so we need some more succinct way to describe it. It turns out that the polytope has far fewer faces than vertices, so it can easily be described by a collection of linear (in)equalities. Indeed, we just need to add appropriate inequalities to \eqref{max-wt-pm-lp-2}, using \Cref{lem:matching-polytope-lem}.
	
	\begin{ftheo}
		Given a graph $G$, its perfect matching polytope is the set $x$ of points in $\R^E$ satisfying
		\begin{align*}
			x_e &\ge 0 \qquad \text{ for all } e \in E, \\
			\sum_{e \text{ incident on }v} x_e &= 1 \qquad \text{ for all } v \in V, \\
			\sum_{e \in \partial S} x_e &\ge 1 \qquad \text{ for all odd sized $S \subseteq V$ with $1 < |S| \le n/2$}.
		\end{align*}
	\end{ftheo}
	Show that the third inequality discounts vertices in \Cref{lem:matching-polytope-lem}. In fact, the above constraint only needs to be added for certain $S$, not necessarily all $S$. However, which $S$ we must add depends on the graph itself. Indeed, when we take the dual, most variables are immediately set to $0$ so not many variables need to be considered. For the complete graph $K_{n}$ on evenly many vertices for instance, we do need to add every such constraint.\\
	Although this is exponentially many constraints, we can still sometimes efficiently solve such linear programs.

\subsection{The spanning tree polytope}

	For example, the problem of finding a minimum weight spanning tree can be solved efficiently, although the \emph{spanning tree polytope}
	\begin{align*}
		\sum_{e \in G[S]} x_e &\le (|S|-1) \qquad \text{ for all $\emptyset \ne S \subseteq V$,} \\
		\sum_{e \in E} x_e &= (n-1).
	\end{align*}
	has exponentially many constraints. Above, $G[S]$ denotes the subgraph of $G$ induced by $S$. Alternatively, we could replace the first constraint with the constraint that for any partition $\mathcal{P}$ of the vertex set, the sum of $x_e$ over edges crossing the partition is at least $|\mathcal{P}|-1$. Kruskal's and Prim's algorithm to find a minimum weight spanning tree can in fact be expressed as appropriate linear programs.\\
	% combinatorial Optimization: Algorithms and Complexity - Papadimitrou and Steiglitz
	We would like to show that the spanning tree polytope is integral, with vertices corresponding to spanning trees. One way to do this is to show that for \emph{any} weight function $w$, there exists a spanning tree with the optimal value. Such a linear program is of the form
	\[
	\begin{array}{ll@{}ll}
	\text{minimize}  & w^\top x &\\
	\text{subject to}& \displaystyle\sum_{\substack{\text{edges between different}\\\text{parts of $\mathcal{P}$}}} x_e \ge |\mathcal{P}|-1 ,  &\qquad \text{for any partition $\mathcal{P}$ of $V$},\\\\
	                 & \sum x_{e} = (n-1). &
	\end{array}
	\]
	The dual of this linear program is
	\[
	\begin{array}{ll@{}ll}
	\text{maximize}  & \displaystyle\sum_{\mathcal{P}} (|\mathcal{P}|-1) y_\mathcal{P} &\\
	\text{subject to}& \displaystyle\sum_{\substack{\text{partitions $\mathcal{P}$} \\ e \text{ crosses }\mathcal{P}}} y_\mathcal{P} \le w_e, &\qquad \text{for all edges }e.\\
	\end{array}
	\]
	Consider Kruskal's algorithm. Start with just the edge having the minimum weight $w_{\operatorname{min}}$. We then consider the partition consisting of all singletons, and set the corresponding $y_\mathcal{P}$ as $w_{\operatorname{min}}$. We then contract this edge, and repeat by altering the right-hand sides in the dual constraints for partitions that involve the minimum weight edge, reducing the weights of the remaining edges. That is, if our current dual values are given by $y$, we replace $w_e$ with $w_e - \sum_{\mathcal{P}} y_\mathcal{P}$. We repeat this until the entire graph contracts to a single vertex. The cost of the dual is the cost of the spanning tree obtained.\\

	Another way that seems to give the spanning tree polytope is
	\begin{align*}
		\sum_{e \in \partial S} x_e &\ge 1 \qquad \text{ for all $\emptyset \ne S \subsetneq V$,} \\
		\sum_{e \in E} x_e &= (n-1),
	\end{align*}
	but it turns out that this polytope is not integral. % half-integral out of a set
	% k4 with three 1-edges and three 1/2, with two diametrically opposite edges connected to each other through a path of 1/2s

	Another seeming definition is
	\begin{align*}
		\sum_{e \in C} x_e &\le |C|-1 \qquad \text{ for all cycles $C$,} \\
		\sum_{e \in E} x_e &= (n-1),
	\end{align*}
	but this is not necessarily integral either.
	% two vertices with three parallel 1/2-edges between them. add a path between them with 0 edges, to make the sum n-1.
	% check whetherh the earlier S definition polytope is integral

	Another problem is that of minimum weight $k$-disjoint spanning trees, where we have the linear program
	\[
	\begin{array}{ll@{}ll}
	\text{minimize}  & \displaystyle\sum_{r=1}^k w_r^\top x_r &\\
	\text{subject to}& \displaystyle\sum_{\substack{\text{edges between different}\\ \text{parts of $\mathcal{P}$}}} x_e \ge k(|\mathcal{P}|-1) ,  &\qquad \text{for any partition $\mathcal{P}$ of $V$},\\\\
	                 & \sum x_{e} = k(n-1). &
	\end{array}
	\]
	There is a generalization of Kruskal's algorithm that works for this. Consider the $2$-disjoint spanning trees problem. If we have two parallel minimum weight edges, both must in the spanning trees, so we can contract and run the algorithm on the resulting graph. Here, we set $y_S = w_{\operatorname{min}}$ as before, where $y_S$ is the partition into singletons. In general, start picking edges in non-decreasing order of weight. As soon as we obtain a subset of vertices which have two disjoint spanning trees, we contract these into a single vertex and contract. 

\subsection{Matchings in special graphs}

	Matchings are a natural way to phrase problems about coming up with bijections between two sets.\\

	Consider the set of bit strings of length $n$ without the substring $11$. It is easy to show that the number of such strings is equal to the $n$th Fibonacci number. This is even when $n \equiv 1 \pmod{3}$ and odd otherwise. Consider the set of all such strings, and the complete graph on these vertices. Can we find an explicit matching on this graph such that if $n \equiv 1 \pmod{3}$, it is a perfect matching, and otherwise exactly one string is left out? Such a matching can be given by flipping the first letter to a $1$ if it is $0$, changing the first two bits to $10$ if it starts with $00$, and if it starts with $01$, it must start with $010$, so we recurse on the remaining string of length $n-3$. When $n \equiv 2 \pmod{3}$, the string $(010)^{(n-2)/3}01$ is unmatched, and when $n \equiv 0 \pmod{3}$, the string $(010)^{n/3}$ is unmatched.\\
	We can get more non-trivial matchings when we consider a graph other than the complete one, where only specified edges are allowed.\\

	Consider the Catalan numbers given by
	\[ T_n = \frac{1}{n+1} \binom{2n}{n}. \]
	For which $n$ is the $n$th Catalan number even? \\
	There is a famous bijection between $T_n$ and binary trees on $n$ nodes. Using this, by constructing a matching on the complete graph on the latter set, we can prove that $T_n$ is odd iff $n = 2^k-1$ for some $k \ge 1$.\\
	It is not difficult to show (using induction, say) that the complete binary trees are the only one binary trees that every node has an equal number of nodes in its left and right subtree. So, we leave the complete binary tree unmatched (if it exists for the given value of $n$), and for every other tree, we consider the smallest node (in the pre-order ordering) that has a different number of nodes in its two subtrees, and swap them.\\
	We can obtain another bijection using only rotations of binary trees.

	\begin{question}
		Consider the graph on balanced parentheses strings, with two strings being adjacent if we can obtain one from the other by swapping two adjacent characters. Does there always exist a matching on this graph, that is a perfect matching if $n \ne 2^k-1$ and leaves exactly one node unmatched if $n = 2^k-1$? 
	\end{question}

	Another interesting facet of this study is that of \emph{partition identities}.

	\begin{fdef}
		A \emph{partition} of a number $n$ is a non-increasing sequence $n_1 \ge n_2 \ge \cdots \cdots \ge n_k \ge 1$ such that $n = n1 + \cdots + n_k$. Given such a partition $\lambda$, $k$ is said to be the number of parts, and $n_i$ is called a part.
	\end{fdef}

	\begin{ftheo}[Rogers-Ramanujan Identity]
		The number of partitions of $n$ into parts, each of which is congruent to $\pm1 \pmod{5}$, is equal to the number of partitions of $n$ into distinct parts that differ by at least $2$.
	\end{ftheo}
	% For example, when $n = 10$, the partitions of the first kind are
	% \[ 9+1, 6+4, 6+1^4, 4^2+1^2, 4+1^6, 1^{10} \]
	% and the number of partitions of the second kind is
	% \[ 10, 9+1, 8+2, 7+3, 6+4, 6+3+1. \]

	Much of the study of partitions was done by Euler.

	\begin{ftheo}[Euler]
		The number of partitions of $n$ into odd parts equals the number of partitions of $n$ into distinct parts.
	\end{ftheo}
	\begin{proof}
		This uses the fact that any number can uniquely be written as a power of $2$ multiplied by an odd number, and also that any number can be expressed as a sum of powers of $2$. Given a partition of the first form, suppose we have $r$ $k$s, where $k$ is odd. We then write $r$ in binary as $2^{n_1} + 2^{n_2} + \cdots + 2^{n_t}$, and make the second partition have parts $2^{n_i}k$ for $1 \le i \le t$.\\
		To go backwards, we write out each part as a power of $2$ multiplied by an odd number, and group together all parts that have the same odd number.
	\end{proof}

	We can give another algebraic proof. Consider the generating function $P$ of the sequence of number $P_n$ of partitions, given by
	\[ P(x) = \prod_{i \ge 1} \frac{1}{1-x^i}. \]
	Although this is an infinite product, the coefficient of any $x^n$, which is equal to $P_n$, is well-defined.\\
	Similarly, the generating function of the number of partitions with odd parts is given by
	\[ O(x) = \prod_{\substack{i \ge 1 \\ i \text{ odd}}} \frac{1}{1-x^i}. \]
	The generating function of the number of partitions with distinct parts is given by
	\[ D(x) = \prod_{i \ge 1} (1+x). \] 
	Every (finite) coefficient of $O$ and $D$ is equal! Indeed,
	\begin{align*}
		\frac{D(x)}{O(x)} &= ((1-x)(1-x^3)(1-x^5)\cdots) ((1+x)(1+x^2)(1+x^3)\cdots) \\
			&= \left( (1-x) \prod_{k \ge 1} (1+x^{2^k}) \right) \left( (1-x^3) \prod_{k \ge 1} (1+x^{2^k\cdot 3}) \right) \cdots \left((1-x^{2r+1})\prod_{k \ge 1} (1+x^{2^k\cdot(2r+1)})\right) \cdots
	\end{align*}
	and any finite coefficient of each of the parts is equal to $0$.\\

	Let us next study matchings of the $n$-dimensional hypercube. When $n$ is odd, consider the induced subgraph on vertices whose corresponding subsets of $[n]$ are of size $(n-1)/2$ or $(n+1)/2$. This is a $(n+1)/2$-regular bipartite graph, so can be partitioned into $(n+1)/2$ perfect matchings. Can we find an explicit description of one such set of matchings? \\
	For a long time, the existence of a Hamiltonian cycle of this graph has been an open problem, but was resolved recently. ***cite***\\

	Now, we can represent a subset of size $(n-1)/2$ by a path $x_1x_2\cdots x_n$ on a lattice, taking a unit step northwest $(1,1)$ if $x_i$ belongs to the set and southwest $(1,-1)$ otherwise. A set then describes a path from $(0,0)$ to $(n,-1)$. Similarly, a subset of size $(n+1)/2$ corresponds to a path from $(0,0)$ to $(n,1)$. \\
	% \emph{Notation in class uses a unit step of slope $+1$ if the element belongs to the class and $-1$ otherwise}.
	Now, consider the rightmost peak (a point of largest $y$ coordinate) on this path, which has $x$ coordinate less than $n$. We then swap the element after this peak, adding it to the set. This gives a set with $(n+1)/2$ elements. Furthermore, this function describes a bijection since we can get back by flipping the element to the left of the leftmost peak. This thus describes a matching on the graph, and was originally proposed by Greene and Kleitman.\\
	This rule can be applied to any set of size $k < n/2$ to get a corresponding set of size $k+1$. It turns out that repeating this process over and over for a subset of size $k$ necessarily goes up till at least size $n-k$ (but it could go even further). This gives a symmetric chain decomposition of the lattice. \\

	% difference in y-value of peak and y-value of rightmost point is at least n-2k and decreases by 1 at each step, so goes up till n-k.
	% horizontal line sweeping from top to bottom. order decreases from right to left.
	% 0 1 1 0 1 0 0
	%    /\1/\0
	% \3/     \2
	% reverse operation is top-down but order the ascending edges from left to right.

	We can also look at mutlisubsets of a multiset. In this case, the graph is not even regular in the first case. For exampl,e suppose the set has $3$ $x_1$s, $2$ $x_2$s, and $1$ $x_3$ and $x_4$, denoted $3,2,1,1$. Then, $0,1,1,1$ has degree $2$ but $2,1,0,0$ has degree $4$. The graph need not be regular, so it is not immediately clear if there even exists a perfect matching.\\
	We can encode a multisubset as a path by going up $k_1$ times and down $c_1-k_1$ times if $x_1$ appears $k_1$ times, where $c_1$ is the total number of occurrences of $x_1$. The idea is again similar, flipping the segment after the rightmost peak. Even in this case, we get a symmetric chain decomposition. \\
	If $c_1 = c_2 \ge \cdots \ge c_m$, then there exist two disjoint perfect matchings at the middle level. This can be proved by ordering the elements in two different ways.\\

	It is easy to show that in any $k$-regular bipartite graph, every edge is contained in a perfect matching.

	\begin{fdef}
		Given a graph $G$, an edge $e_2$ is \emph{forced} by $e_1$ if every perfect matching containing $e_1$ also contains $e_2$, or no perfect matching containing $e_1$ contains $e_2$.
	\end{fdef}

	The above is not a symmetric relation in general. Is it symmetric in the bipartite case?

	% cubic bridgeless graph has pm -- bridge is an odd induced subgraph with exactly one edge out of it

	\begin{fdef}
		Let $G$ be a $3$-regular bipartite graph, and $e$ an edge that is not contained in a $2$-edge cut. There exists a perfect matching containing $e$ such that $e$ is a chord of a cycle in the complement of the matching.
	\end{fdef}
	\begin{proof}
		It is easy to see that if there does exist a $2$-edge cut containing $e$, $e$ cannot be a chord of a cycle in the complement.\\
		Otherwise, let $e = uv$, and let $uv_1,uv_2,u_1v,u_2v$ also be edges. Clearly, if $e$ is the chord of a cycle in the complement, the cycle must have all $4$ of these edges. Consider the graph $H$ obtained by deleting the vertices $u,v$, and adding the edges $u_1u_2$ and $v_1v_2$. While $H$ is $3$-regular, it need not be bipartite. $H$ is, however, \emph{near-bipartite}, which means that deleting these two edges results in a bipartite graph.\\
		If we show that $H$ has a perfect matching including $u_1u_2$ and $v_1v_2$, we are done. Remove the vertices $u_1u_2$ and $v_1v_2$ to get a graph $H'$. Note that since $e$ is not in a $2$-edge cut, $H'$ does not contain a bridge, i.e., an edge whose removal disconnects it. If this graph does not contain a perfect matching, there is some $X$ such that $|N(X)| < |X|$. Note that at most $4$ edges can go to $\{v_1,v_2\}$, so there are at least $3|X|-4$ edges from $|X|$ to $|N(X)|$. This implies that $|N(X)| = |X|-1$. Consequently, $3|X|-3$ edges go from $|X|$ to $|N(X)|$. This means that one of the $4$ edges incident on $\{v_1,v_2\}$ does not go to $X$, but then this edge is a bridge, a contradiction.
	\end{proof}

	In the Petersen graph, the only $2$-factors have two disjoint $5$-cycles, and no edge is a chord.

	\begin{fdef}
		A graph is said to be $k$-extendable if any set of at most $k$ disjoint edges is contained in a perfect matching.
	\end{fdef}

	\begin{fprop}
		If a bipartite $G(A,B)$ is $k$-extendable, for any $X \subseteq A$ with $|X| \le |A|-k$, $|N(X)| \ge |X|+k$.
	\end{fprop}